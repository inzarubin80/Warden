# Задачи проекта — ЭкоМонитор

Ниже перевод списка задач по подсистемам с ориентировочной оценкой времени.

1) Мобильное приложение (Mobile)
- Создать скелет мобильного приложения (React Native) — 3 дня
- Реализовать OAuth (VK, Yandex) + JWT (аутентификация) — 3 дня
- Реализовать интерфейс карты и поток подачи жалобы/репорта — 4 дня
- Реализовать загрузку фото и поток presigned S3 — 3 дня
- Реализовать офлайн‑БД и очередь синхронизации — 5 дней
- Добавить push‑уведомления (FCM / APNs) — 2 дня
- Написать unit и E2E тесты для мобильного клиента — 3 дня
- Настроить CI для мобильного приложения (сборка и тесты) — 2 дня

2) Сервер (Go)
- Создать скелет сервера на Go (`net/http`) — 2 дня
- Реализовать OAuth (VK/Yandex) и выдачу JWT — 3 дня
- Спроектировать схему БД и миграции (Postgres) + добавить поля для модерации — 2 дня
- Реализовать CRUD API для нарушений с поддержкой moderation flow (moderation_status, audit_logs) — 4 дня
- Реализовать presigned upload в S3 и обработку фото (resize, webp) — 3 дня
- Реализовать push‑уведомления и realtime (WebSocket) сервис — 3 дня
- Реализовать фоновые воркеры: image processing (Go) и ML moderation worker (Python, `nsfw_detector` + `detoxify`) — 4 дня
- Реализовать фоновые воркеры: image processing (Go) — 2 дня
- Написать unit и интеграционные тесты для сервера и воркеров — 4 дня
- Настроить CI/CD для сервера и worker'ов (build/test/push) — 2 дня

5) Сервис модерации (отдельный микросервис, Python)
- Создать скелет микросервиса (FastAPI) и очередь (Redis) — 1 день
- Интегрировать ML: `nsfw_detector` и `detoxify`, подготовка окружения (CPU/GPU) — 2 дня
- Реализовать internal API и контракт с Go‑сервером (POST /internal/moderation/result, status callbacks) — 1 день
- Реализовать админ‑API/панель для модераторов (approve/reject, priority queue) — 2 дня
- Контейнеризация, тесты и деплой (Docker, k8s manifest) — 1 день
- Документация и мониторинг (metrics, alerts, SLA) — 1 день

  API (эндпоинты) — перечень для реализации (метод, путь, краткое назначение)

  - POST /auth/oauth/{provider}/callback — обмен кода на токен и выдача JWT (public)
  - GET /me — получить профиль текущего пользователя (auth)
  - PATCH /me — обновить профиль пользователя (auth)

  - POST /upload — инициация presigned upload в S3 (возвращает presigned URL / storage_key) (auth)
  - POST /upload/complete — опционально: подтверждение завершения загрузки (auth)

  - POST /violations — создать нарушение (coords, type, description, список storage_key для фото) (auth optional)
  - GET /violations — список нарушений (фильтры: bbox, type, status, date, pagination)
  - GET /violations/{id} — детали нарушения (включая фото, подтверждения, история модерации)
  - POST /violations/{id}/confirm — подтвердить нарушение (auth optional)
  - POST /violations/{id}/propose_resolve — предложить закрытие (с фото/комментарием) (auth)
  - POST /violations/{id}/resolve — отметить устранённым (могут требовать модерации) (auth)

  - GET /violations/pending_moderation — список для модераторов (moderator/admin)
  - GET /moderation/{violation_id} — детальная карточка модерации (moderator/admin)
  - POST /moderation/{violation_id}/action — {action: approve|reject, reason} (moderator/admin)

  - POST /devices/register — зарегистрировать device token для push (auth)
  - DELETE /devices/{token} — удалить токен (auth)

  - GET /notifications — список уведомлений (auth)
  - POST /notifications/{id}/read — пометить уведомление прочитанным (auth)

  - WS /realtime — WebSocket подписка на обновления (auth)

  - GET /admin/users — список пользователей (admin)
  - GET /admin/violations — расширенный список/фильтрация (admin)
  - GET /admin/stats — статистика (admin)

  - POST /internal/moderation/result — internal endpoint: воркер отправляет результат модерации (auth/internal)

  - GET /health — healthcheck
  - GET /metrics — Prometheus metrics endpoint

3) Админка (Frontend / Mobile admin)
- Создать скелет админ‑фронтенда (React) — 2 дня
- Интегрировать аутентификацию и роли для админов/модераторов — 1 день
- Реализовать интерфейс модерации нарушений (список, просмотр, approve/reject) — 3 дня
- Добавить базовую панель статистики — 2 дня
- Настроить CI для админки — 1 день

4) Инфраструктура и документация
- Подготовить Docker‑окружение и дев‑инструкции — 2 дня
- Написать developer docs и OpenAPI‑спецификацию (минимум для propose/approve) — 2 дня
 
Итоговые временные оценки
- Мобильное приложение (Mobile): 25 дней
- Сервер (Go): 27 дней
- Админка (Frontend / Mobile admin): 9 дней
- Инфраструктура и документация: 4 дня

- Общая оценка проекта (MVP набор фич выше): 65 дней

Примечания:
- Оценки даны в человеко‑днях и являются ориентировочными для команды из 2‑3 разработчиков.
- Для MVP рекомендуется сначала реализовать минимально необходимые фичи: аутентификацию, создание нарушений с фото, отображение на карте, подтверждение (threshold = 3 или модератор), ручное закрытие модератором, и S3‑загрузки.


